p8105_hw5_jw4690
================
Jingxi Wang
2024-11-06

## Problem 1

``` r
bday_sim = function(n) {
  bdays = sample(1:365, size = n, replace = TRUE)
  duplicate = length(unique(bdays)) < n
  return(duplicate)
}

sim_res = expand_grid(
  n = 2:50,
  iter = 1:10000
) |>
  mutate(res = map_lgl(n, bday_sim)) |>
  group_by(n) |>
  summarize(prob = mean(res))

sim_res_plot = sim_res |>
  ggplot(aes(x = n, y = prob)) +
  geom_line() +
  labs(
    title = "Probability of Shared Birthdays as a Function of Group Size",
    x = "Group Size",
    y = "Probability of at least two people sharing a birthday"
  )

sim_res_plot
```

![](p8105_hw5_jw4690_files/figure-gfm/unnamed-chunk-1-1.png)<!-- -->

The probability of shared birthdays increases sharply as the group size
grows. As the group size reaches around 50, the probability approaches
nearly 100%, indicating that it’s almost certain that at least two
people in the group will share a birthday.

## Problem 2

``` r
sim_power = function(mu, n = 30, sigma = 5, alpha = 0.05) {
  sim_data = 
    tibble(
      x = rnorm(n, mean = mu, sd = sigma)
      )
  
  t_test = t.test(sim_data$x, mu = 0)
  result = broom::tidy(t_test)
  
  out_df = tibble(
    estimate = result$estimate,
    p_value = result$p.value
  )
  
  return(out_df)
}
```

``` r
n_sim = 5000
mu_values = c(0, 1, 2, 3, 4, 5, 6)

sim_res_2 = expand_grid(
  mu = mu_values,
  iter = 1:n_sim
) |>
  mutate(sim_output = map(mu, sim_power)) |>
  unnest(sim_output) |>
  group_by(mu) |>
  summarize(
    power = mean(p_value < 0.05),
    avg_estimate = mean(estimate),
    avg_estimate_rejected = mean(estimate[p_value < 0.05])
  )
```

``` r
# Make a plot showing the proportion of times the null was rejected (the power of the test) on the y axis and the true value of μ on the x axis.

sim_res_2_plot = sim_res_2 |>
  ggplot(aes(x = mu, y = power)) +
  geom_line() +
  labs(
    title = "Power of the Test as a Function of Effect Size (mu)",
    x = expression(mu),
    y = "Power (Probability of Rejecting Null)"
  )

sim_res_2_plot
```

![](p8105_hw5_jw4690_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

``` r
# average estimate of μ_hat on the y axis and the true value of μ on the x axis.

sim_res_2_plot2 = sim_res_2 |>
  ggplot(aes(x = mu, y = avg_estimate)) +
  geom_line(color = "blue") +
  labs(
    title = "Average Estimate of Mu vs True Value of Mu",
    x = expression(mu),
    y = "Average Estimate of Mu"
  )

sim_res_2_plot2
```

![](p8105_hw5_jw4690_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->
